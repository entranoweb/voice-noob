{"version":3,"file":"widget.js","sources":["../../../src/widget/widget.ts"],"sourcesContent":["/**\n * Voice Noob Widget - Standalone Web Component\n *\n * This script creates a floating voice chat widget that can be embedded on any website.\n * Usage:\n *   <script src=\"https://voicenoob.com/widget/v1/widget.js\" defer></script>\n *   <voice-agent agent-id=\"ag_xK9mN2pQ\"></voice-agent>\n */\n\ntype AgentState = \"idle\" | \"listening\" | \"thinking\" | \"speaking\";\n\n// Styles for the widget\nconst styles = `\n  .va-widget-container {\n    position: fixed;\n    z-index: 9999;\n    font-family: -apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif;\n  }\n\n  .va-widget-container.bottom-right {\n    bottom: 20px;\n    right: 20px;\n  }\n\n  .va-widget-container.bottom-left {\n    bottom: 20px;\n    left: 20px;\n  }\n\n  .va-widget-container.top-right {\n    top: 20px;\n    right: 20px;\n  }\n\n  .va-widget-container.top-left {\n    top: 20px;\n    left: 20px;\n  }\n\n  .va-widget-button {\n    display: flex;\n    align-items: center;\n    gap: 8px;\n    padding: 12px 20px;\n    background: var(--va-primary, #6366f1);\n    color: white;\n    border: none;\n    border-radius: 50px;\n    cursor: pointer;\n    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15), 0 0 0 0 var(--va-glow-color, rgba(99, 102, 241, 0));\n    transition: all 0.3s ease;\n    font-size: 14px;\n    font-weight: 500;\n  }\n\n  .va-widget-button:hover {\n    transform: scale(1.05);\n    box-shadow: 0 6px 32px rgba(0, 0, 0, 0.2), 0 0 16px 4px var(--va-glow-color, rgba(99, 102, 241, 0.3));\n  }\n\n  .va-widget-button:active {\n    transform: scale(0.98);\n  }\n\n  .va-widget-button svg {\n    width: 18px;\n    height: 18px;\n  }\n\n  .va-widget-orb {\n    width: 36px;\n    height: 36px;\n    border-radius: 50%;\n    position: relative;\n    overflow: hidden;\n    transition: transform 0.2s ease, box-shadow 0.2s ease;\n  }\n\n  .va-widget-orb-gradient {\n    position: absolute;\n    inset: 0;\n    border-radius: 50%;\n    background: conic-gradient(\n      from 180deg,\n      var(--va-primary, #6366f1) 0deg,\n      var(--va-primary-60, #6366f188) 90deg,\n      var(--va-primary-30, #6366f144) 180deg,\n      var(--va-primary-60, #6366f188) 270deg,\n      var(--va-primary, #6366f1) 360deg\n    );\n    transition: opacity 0.3s ease;\n  }\n\n  .va-widget-orb-gradient.animated {\n    animation: va-spin 3s linear infinite;\n  }\n\n  .va-widget-orb-inner {\n    position: absolute;\n    inset: 3px;\n    border-radius: 50%;\n    background: white;\n    transition: background-color 0.3s ease;\n  }\n\n  .va-widget-orb-dot {\n    position: absolute;\n    inset: 6px;\n    border-radius: 50%;\n    background: var(--va-primary, #6366f1);\n    opacity: 0.4;\n    transition: all 0.2s ease;\n  }\n\n  .va-widget-orb-dot.active {\n    opacity: 0.8;\n    transform: scale(1.1);\n  }\n\n  /* State-based styling */\n  .va-widget-button.state-listening {\n    --va-glow-color: rgba(34, 197, 94, 0.4);\n    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15), 0 0 12px 4px var(--va-glow-color);\n  }\n\n  .va-widget-button.state-listening .va-widget-orb-dot {\n    background: #22c55e;\n    opacity: 0.9;\n    animation: va-pulse 1.5s ease-in-out infinite;\n  }\n\n  .va-widget-button.state-thinking {\n    --va-glow-color: rgba(251, 191, 36, 0.4);\n    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15), 0 0 12px 4px var(--va-glow-color);\n  }\n\n  .va-widget-button.state-thinking .va-widget-orb-dot {\n    background: #fbbf24;\n    opacity: 0.9;\n    animation: va-think-pulse 0.8s ease-in-out infinite;\n  }\n\n  .va-widget-button.state-speaking {\n    --va-glow-color: rgba(59, 130, 246, 0.4);\n    box-shadow: 0 4px 24px rgba(0, 0, 0, 0.15), 0 0 12px 4px var(--va-glow-color);\n  }\n\n  .va-widget-button.state-speaking .va-widget-orb-dot {\n    background: #3b82f6;\n    opacity: 0.9;\n    animation: va-speak-pulse 0.3s ease-in-out infinite;\n  }\n\n  .va-widget-popup {\n    position: absolute;\n    bottom: 60px;\n    right: 0;\n    width: 380px;\n    height: 520px;\n    background: transparent;\n    overflow: hidden;\n    opacity: 0;\n    transform: translateY(20px) scale(0.95);\n    transition: all 0.3s ease;\n    pointer-events: none;\n  }\n\n  .va-widget-popup.open {\n    opacity: 1;\n    transform: translateY(0) scale(1);\n    pointer-events: auto;\n  }\n\n  .va-widget-popup iframe {\n    width: 100%;\n    height: 100%;\n    border: none;\n  }\n\n  .va-widget-branding {\n    text-align: center;\n    font-size: 11px;\n    color: #9ca3af;\n    margin-top: 8px;\n  }\n\n  .va-widget-branding a {\n    color: var(--va-primary, #6366f1);\n    text-decoration: none;\n  }\n\n  @keyframes va-spin {\n    from { transform: rotate(0deg); }\n    to { transform: rotate(360deg); }\n  }\n\n  @keyframes va-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.9; }\n    50% { transform: scale(1.15); opacity: 1; }\n  }\n\n  @keyframes va-think-pulse {\n    0%, 100% { transform: scale(1); opacity: 0.7; }\n    50% { transform: scale(1.1); opacity: 1; }\n  }\n\n  @keyframes va-speak-pulse {\n    0%, 100% { transform: scale(1); }\n    50% { transform: scale(1.2); }\n  }\n\n  @media (max-width: 480px) {\n    .va-widget-popup {\n      position: fixed;\n      inset: 0;\n      width: 100%;\n      height: 100%;\n      border-radius: 0;\n      bottom: 0;\n      right: 0;\n    }\n  }\n`;\n\nclass VoiceAgentElement extends HTMLElement {\n  private shadow: ShadowRoot;\n  private isOpen = false;\n  private agentId: string | null = null;\n  private position: string = \"bottom-right\";\n  private theme: string = \"auto\";\n  private buttonText: string = \"Voice Chat\";\n  private baseUrl: string = \"\";\n  private primaryColor: string = \"#6366f1\";\n  private currentState: AgentState = \"idle\";\n  private messageHandler: ((event: MessageEvent) => void) | null = null;\n\n  constructor() {\n    super();\n    this.shadow = this.attachShadow({ mode: \"open\" });\n  }\n\n  static get observedAttributes() {\n    return [\"agent-id\", \"position\", \"theme\", \"button-text\", \"base-url\", \"primary-color\"];\n  }\n\n  attributeChangedCallback(name: string, _oldValue: string, newValue: string) {\n    switch (name) {\n      case \"agent-id\":\n        this.agentId = newValue;\n        break;\n      case \"position\":\n        this.position = newValue || \"bottom-right\";\n        break;\n      case \"theme\":\n        this.theme = newValue || \"auto\";\n        break;\n      case \"button-text\":\n        this.buttonText = newValue || \"Voice Chat\";\n        break;\n      case \"base-url\":\n        this.baseUrl = newValue || \"\";\n        break;\n      case \"primary-color\":\n        this.primaryColor = newValue || \"#6366f1\";\n        break;\n    }\n    if (this.isConnected) {\n      this.render();\n    }\n  }\n\n  connectedCallback() {\n    // Read attributes\n    this.agentId = this.getAttribute(\"agent-id\");\n    this.position = this.getAttribute(\"position\") ?? \"bottom-right\";\n    this.theme = this.getAttribute(\"theme\") ?? \"auto\";\n    this.buttonText = this.getAttribute(\"button-text\") ?? \"Voice Chat\";\n    this.baseUrl = this.getAttribute(\"base-url\") ?? this.detectBaseUrl();\n    this.primaryColor = this.getAttribute(\"primary-color\") ?? \"#6366f1\";\n\n    this.render();\n\n    // Set up message handler\n    this.messageHandler = (event: MessageEvent) => this.handleMessage(event);\n    window.addEventListener(\"message\", this.messageHandler);\n  }\n\n  disconnectedCallback() {\n    // Clean up message handler\n    if (this.messageHandler) {\n      window.removeEventListener(\"message\", this.messageHandler);\n      this.messageHandler = null;\n    }\n  }\n\n  private detectBaseUrl(): string {\n    // Try to detect base URL from the script src\n    const scripts = document.getElementsByTagName(\"script\");\n    for (const script of scripts) {\n      if (script.src?.includes(\"widget\")) {\n        try {\n          const url = new URL(script.src);\n          return `${url.protocol}//${url.host}`;\n        } catch {\n          // Ignore\n        }\n      }\n    }\n    // Fallback to current origin\n    return window.location.origin;\n  }\n\n  private hexToHSL(hex: string): { h: number; s: number; l: number } {\n    const result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(hex);\n    if (!result?.[1] || !result[2] || !result[3]) return { h: 0, s: 0, l: 50 };\n\n    const r = parseInt(result[1], 16) / 255;\n    const g = parseInt(result[2], 16) / 255;\n    const b = parseInt(result[3], 16) / 255;\n\n    const max = Math.max(r, g, b);\n    const min = Math.min(r, g, b);\n    let h = 0;\n    let s = 0;\n    const l = (max + min) / 2;\n\n    if (max !== min) {\n      const d = max - min;\n      s = l > 0.5 ? d / (2 - max - min) : d / (max + min);\n      switch (max) {\n        case r:\n          h = ((g - b) / d + (g < b ? 6 : 0)) / 6;\n          break;\n        case g:\n          h = ((b - r) / d + 2) / 6;\n          break;\n        case b:\n          h = ((r - g) / d + 4) / 6;\n          break;\n      }\n    }\n\n    return { h: Math.round(h * 360), s: Math.round(s * 100), l: Math.round(l * 100) };\n  }\n\n  private render() {\n    if (!this.agentId) {\n      console.error(\"VoiceAgent: agent-id attribute is required\");\n      return;\n    }\n\n    // Generate CSS color variations\n    const hsl = this.hexToHSL(this.primaryColor);\n    const primary60 = `hsla(${hsl.h}, ${hsl.s}%, ${hsl.l}%, 0.53)`;\n    const primary30 = `hsla(${hsl.h}, ${hsl.s}%, ${hsl.l}%, 0.27)`;\n\n    // Apply custom primary color to styles\n    const customStyles = styles\n      .replace(/var\\(--va-primary, #6366f1\\)/g, this.primaryColor)\n      .replace(/var\\(--va-primary-60, #6366f188\\)/g, primary60)\n      .replace(/var\\(--va-primary-30, #6366f144\\)/g, primary30);\n\n    this.shadow.innerHTML = `\n      <style>\n        :host {\n          --va-primary: ${this.primaryColor};\n          --va-primary-60: ${primary60};\n          --va-primary-30: ${primary30};\n        }\n        ${customStyles}\n      </style>\n      <div class=\"va-widget-container ${this.position}\">\n        <div class=\"va-widget-popup\" id=\"popup\">\n          <iframe\n            src=\"${this.baseUrl}/embed/${this.agentId}?theme=${this.theme}&autostart=true\"\n            allow=\"microphone\"\n            title=\"Voice Agent\"\n          ></iframe>\n        </div>\n        <div class=\"va-widget-button-wrapper\">\n          <button class=\"va-widget-button\" id=\"toggle\">\n            <div class=\"va-widget-orb\" id=\"orb\">\n              <div class=\"va-widget-orb-gradient\" id=\"orb-gradient\"></div>\n              <div class=\"va-widget-orb-inner\"></div>\n              <div class=\"va-widget-orb-dot\" id=\"orb-dot\"></div>\n            </div>\n            <span id=\"button-text\">${this.buttonText}</span>\n          </button>\n          <div class=\"va-widget-branding\">\n            Powered by <a href=\"https://voicenoob.com\" target=\"_blank\" rel=\"noopener noreferrer\">Voice Noob</a>\n          </div>\n        </div>\n      </div>\n    `;\n\n    // Add event listeners\n    this.shadow.getElementById(\"toggle\")?.addEventListener(\"click\", () => this.toggle());\n  }\n\n  private toggle() {\n    this.isOpen = !this.isOpen;\n    const popup = this.shadow.getElementById(\"popup\");\n    const buttonText = this.shadow.getElementById(\"button-text\");\n    const orbGradient = this.shadow.getElementById(\"orb-gradient\");\n    const orbDot = this.shadow.getElementById(\"orb-dot\");\n    const iframe = popup?.querySelector(\"iframe\");\n\n    if (popup) {\n      popup.classList.toggle(\"open\", this.isOpen);\n    }\n\n    if (buttonText) {\n      buttonText.textContent = this.isOpen ? \"Close\" : this.buttonText;\n    }\n\n    if (orbGradient) {\n      orbGradient.classList.toggle(\"animated\", this.isOpen);\n    }\n\n    if (orbDot) {\n      orbDot.classList.toggle(\"active\", this.isOpen);\n    }\n\n    // Send message to iframe to restart session when opening\n    if (this.isOpen && iframe?.contentWindow) {\n      iframe.contentWindow.postMessage({ type: \"voice-agent:start\" }, \"*\");\n    }\n\n    // Reset state when closing\n    if (!this.isOpen) {\n      this.updateState(\"idle\");\n    }\n  }\n\n  private updateState(state: AgentState) {\n    this.currentState = state;\n    const button = this.shadow.getElementById(\"toggle\");\n\n    if (button) {\n      // Remove all state classes\n      button.classList.remove(\"state-idle\", \"state-listening\", \"state-thinking\", \"state-speaking\");\n      // Add current state class\n      if (state !== \"idle\") {\n        button.classList.add(`state-${state}`);\n      }\n    }\n  }\n\n  private handleMessage(event: MessageEvent) {\n    // Handle messages from the iframe\n    const data = event.data;\n\n    if (!data || typeof data !== \"object\") return;\n\n    // Handle close request\n    if (data.type === \"voice-agent:close\") {\n      if (this.isOpen) {\n        this.toggle();\n      }\n      return;\n    }\n\n    // Handle state updates from embed\n    if (data.type === \"voice-agent:state\") {\n      const state = data.state as AgentState;\n      if ([\"idle\", \"listening\", \"thinking\", \"speaking\"].includes(state)) {\n        this.updateState(state);\n      }\n      return;\n    }\n\n    // Handle audio level updates for dynamic effects\n    if (data.type === \"voice-agent:audio-level\") {\n      const level = data.level as number;\n      this.updateAudioLevel(level);\n    }\n  }\n\n  private updateAudioLevel(level: number) {\n    const orb = this.shadow.getElementById(\"orb\");\n    const button = this.shadow.getElementById(\"toggle\");\n\n    if (orb && this.isOpen) {\n      // Scale orb based on audio level\n      const scale = 1 + level * 0.2;\n      orb.style.transform = `scale(${scale})`;\n    }\n\n    if (button && this.isOpen && this.currentState === \"speaking\") {\n      // Dynamic glow intensity based on audio level\n      const glowSize = 12 + level * 12;\n      const glowOpacity = 0.4 + level * 0.4;\n      button.style.boxShadow = `0 4px 24px rgba(0, 0, 0, 0.15), 0 0 ${glowSize}px ${glowSize / 2}px rgba(59, 130, 246, ${glowOpacity})`;\n    }\n  }\n}\n\n// Register the custom element\nif (!customElements.get(\"voice-agent\")) {\n  customElements.define(\"voice-agent\", VoiceAgentElement);\n}\n\n// Export for potential module usage\nexport { VoiceAgentElement };\n"],"names":["styles","VoiceAgentElement","HTMLElement","constructor","super","this","isOpen","agentId","position","theme","buttonText","baseUrl","primaryColor","currentState","messageHandler","shadow","attachShadow","mode","observedAttributes","attributeChangedCallback","name","_oldValue","newValue","isConnected","render","connectedCallback","getAttribute","detectBaseUrl","event","handleMessage","window","addEventListener","disconnectedCallback","removeEventListener","scripts","document","getElementsByTagName","script","_a","src","includes","url","URL","protocol","host","location","origin","hexToHSL","hex","result","exec","h","s","l","r","parseInt","g","b","max","Math","min","d","round","console","error","hsl","primary60","primary30","customStyles","replace","innerHTML","getElementById","toggle","popup","orbGradient","orbDot","iframe","querySelector","classList","textContent","contentWindow","postMessage","type","updateState","state","button","remove","add","data","level","updateAudioLevel","orb","scale","style","transform","glowSize","glowOpacity","boxShadow","customElements","get","define"],"mappings":"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"}